<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="assets/css/reset.css">
    <link rel="stylesheet" href="assets/css/style.css">

    <link href="https://fonts.googleapis.com/css2?family=Abel&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>

<body>
    <h1 class="logo logo--top js-trigger">
        portfolio
    </h1>

    <div class="resize">
        <div class="resize__inner">
            <p>브라우저 화면을 최적화 시켜주세요!</p>
        </div>
    </div>

    <a href="#" target="_blank" class="hi">work</a>

    <div class="scroll" data-scroll>
        <nav class="filter">
            <ul class="filter__list">
                <li class="filter__item">
                    <a href="#" class="filter__link is-active js-trigger">
                        <div class="filter__link-mask" area-hidden><span>About</span></div>
                        About
                    </a>
                </li>
                <li class="filter__item">
                    <a href="#" class="filter__link js-trigger">
                        <div class="filter__link-mask" area-hidden><span>Site</span></div>
                        Site
                    </a>
                </li>
                <li class="filter__item">
                    <a href="#" class="filter__link js-trigger">
                        <div class="filter__link-mask" area-hidden><span>Script</span></div>
                        Script
                    </a>
                </li>
                <li class="filter__item">
                    <a href="#" class="filter__link js-trigger">
                        <div class="filter__link-mask" area-hidden><span>contact</span></div>
                        contact
                    </a>
                </li>
            </ul>
        </nav>

        <div class="scroll-content" data-scroll-content>
            <article class="slide slide--1 js-slide">
                <div class="slide__inner">
                    <div class="slide__img js-transition-img">
                        <figure class="js-transition-img__inner">
                            <img src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?crop=entropy&cs=tinysrgb&fm=jpg&ixlib=rb-1.2.1&q=80&raw_url=true&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170"
                                draggable="false">
                        </figure>
                    </div>
                </div>
            </article>

            <article class="slide slide--2 js-slide">
                <div class="slide__inner">
                    <div class="slide__img js-transition-img">
                        <figure class="js-transition-img__inner">
                            <img src="https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?crop=entropy&cs=tinysrgb&fm=jpg&ixlib=rb-1.2.1&q=80&raw_url=true&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170"
                                draggable="false">
                        </figure>
                    </div>
                </div>
            </article>

            <article class="slide slide--3 js-slide">
                <div class="slide__inner">
                    <div class="slide__img">
                        <figure>
                            <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/58281/project-three.png"
                                draggable="false">
                        </figure>
                    </div>
                </div>
            </article>

            <article class="slide slide--1 js-slide">
                <div class="slide__inner">
                    <div class="slide__img">
                        <figure>
                            <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/58281/project-one.png"
                                draggable="false">
                        </figure>
                    </div>
                </div>
            </article>

            <article class="slide slide--2 js-slide">
                <div class="slide__inner">
                    <div class="slide__img">
                        <figure>
                            <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/58281/project-two.png"
                                draggable="false">
                        </figure>
                    </div>
                </div>
            </article>

            <article class="slide slide--3 js-slide">
                <div class="slide__inner">
                    <div class="slide__img">
                        <figure>
                            <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/58281/project-three.png"
                                draggable="false">
                        </figure>
                    </div>
                </div>
            </article>

        </div>

        <div class="scroll-content scroll-content--last" data-scroll-content>
            <article class="slide slide--1 js-slide">
                <div class="slide__inner">
                    <div class="slide__sub-title"><span>SITE01</span></div>
                    <h1 class="slide__title">
                        <div class="js-transition-title">webStandard</div>
                    </h1>
                    <div class="slide__img slide__img--proxy"></div>
                    <div class="slide__project">웹표준 사이트</div>
                </div>
            </article>

            <article class="slide slide--2 js-slide">
                <div class="slide__inner">
                    <div class="slide__sub-title"><span>SITE02</span></div>
                    <h1 class="slide__title">
                        <div class="js-transition-title">Responsive</div>
                    </h1>
                    <div class="slide__img slide__img--proxy"></div>
                    <div class="slide__project"><a href="#">반응형 디자인 VIEW</a></div>
                </div>
            </article>

            <article class="slide slide--3 js-slide">
                <div class="slide__inner">
                    <div class="slide__sub-title"><span>SITE03</span></div>
                    <h1 class="slide__title">Oak Refuge</h1>
                    <div class="slide__img slide__img--proxy"></div>
                    <div class="slide__project">Corpus Studio</div>
                </div>
            </article>

            <article class="slide slide--1 js-slide">
                <div class="slide__inner">
                    <div class="slide__sub-title"><span>SITE04</span></div>
                    <h1 class="slide__title">Teton Residence</h1>
                    <div class="slide__img slide__img--proxy"></div>
                    <div class="slide__project">Ro Rocket Design</div>
                </div>
            </article>

            <article class="slide slide--2 js-slide">
                <div class="slide__inner">
                    <div class="slide__sub-title"><span>SITE05</span></div>
                    <h1 class="slide__title">Oak Refuge</h1>
                    <div class="slide__img slide__img--proxy"></div>
                    <div class="slide__project">Corpus Studio</div>
                </div>
            </article>

            <article class="slide slide--3 js-slide">
                <div class="slide__inner">
                    <div class="slide__sub-title"><span>SITE06</span></div>
                    <h1 class="slide__title">Teton Residence</h1>
                    <div class="slide__img slide__img--proxy"></div>
                    <div class="slide__project">Ro Rocket Design</div>
                </div>
            </article>
        </div>

        <div class="scrollbar" data-scrollbar>
            <div class="scrollbar__handle js-scrollbar__handle"></div>
        </div>

    </div>

    <div class="mask js-mask">
        <div class="mask__slice js-mask__slice"></div>
        <div class="mask__slice js-mask__slice"></div>
        <div class="mask__slice js-mask__slice"></div>
        <div class="mask__slice js-mask__slice"></div>
        <div class="mask__slice js-mask__slice"></div>
        <div class="mask__inner">
            <figure class="logo logo--mask">
                <div class="js-logo">
                    developer
                </div>
            </figure>
            <div class="mask-line js-mask-line">
                <div class="mask-line__inner js-mask-line"></div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.0.2/TweenMax.min.js"></script>
    <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
    <script>
        const math = {
            lerp: (a, b, n) => {
                return (1 - n) * a + n * b
            },
            norm: (value, min, max) => {
                return (value - min) / (max - min)
            }
        }

        const config = {
            height: window.innerHeight,
            width: window.innerWidth
        }

        class Smooth {
            constructor() {
                this.bindAll()

                this.el = document.querySelector('[data-scroll]')
                this.content = [...document.querySelectorAll('[data-scroll-content]')]

                this.dom = {
                    el: this.el,
                    content: this.content,
                    elems: [
                        [...this.content[0].querySelectorAll('.js-slide')],
                        [...this.content[1].querySelectorAll('.js-slide')]
                    ],
                    handle: this.el.querySelector('.js-scrollbar__handle')
                }

                this.data = {
                    total: this.dom.elems[0].length - 1,
                    current: 0,
                    last: {
                        one: 0,
                        two: 0
                    },
                    on: 0,
                    off: 0
                }

                this.bounds = {
                    elem: 0,
                    content: 0,
                    width: 0,
                    max: 0,
                    min: 0
                }

                this.state = {
                    dragging: false
                }

                this.rAF = null
                this.parallax = null

                this.init()
            }

            bindAll() {
                ['scroll', 'run', 'resize']
                .forEach((fn) => this[fn] = this[fn].bind(this))
            }

            setStyles() {
                this.dom.el.style.position = 'fixed';
                this.dom.el.style.top = 0;
                this.dom.el.style.left = 0;
                this.dom.el.style.height = '100%'
                this.dom.el.style.width = '100%'
                this.dom.el.style.overflow = 'hidden'
            }

            setBounds(elems) {
                let w = 0

                elems.forEach((el, index) => {
                    const bounds = el.getBoundingClientRect()

                    el.style.position = 'absolute'
                    el.style.top = 0
                    el.style.left = `${w}px`

                    w = w + bounds.width

                    this.bounds.width = w
                    this.bounds.max = this.bounds.width - config.width

                    if ((this.data.total) === index && elems === this.dom.elems[0]) {
                        this.dom.content[0].style.width = `${w}px`
                        this.dom.content[1].style.width = `${w}px`
                        document.body.style.height = `${w}px`
                    }
                })
            }

            resize() {
                this.setBounds(this.dom.elems[0])
                this.setBounds(this.dom.elems[1])
                this.scroll()
            }

            preload() {
                imagesLoaded(this.dom.content, (instance) => {
                    this.setBounds(this.dom.elems[0])
                    this.setBounds(this.dom.elems[1])
                })
            }

            scroll() {
                if (this.state.dragging) return

                this.data.current = window.scrollY
                this.clamp()
            }

            drag(e) {
                this.data.current = window.scrollY - (e.clientX - this.data.on)
                this.clamp()
            }

            clamp() {
                this.data.current = Math.min(Math.max(this.data.current, 0), this.bounds.max)
            }

            run() {
                this.data.last.one = math.lerp(this.data.last.one, this.data.current, 0.085)
                this.data.last.one = Math.floor(this.data.last.one * 100) / 100

                this.data.last.two = math.lerp(this.data.last.two, this.data.current, 0.08)
                this.data.last.two = Math.floor(this.data.last.two * 100) / 100

                const diff = this.data.current - this.data.last.one
                const acc = diff / config.width
                const velo = +acc
                const bounce = 1 - Math.abs(velo * 0.25)
                const skew = velo * 7.5

                this.dom.content[0].style.transform =
                    `translate3d(-${this.data.last.one.toFixed(2)}px, 0, 0) scaleY(${bounce}) skewX(${skew}deg)`
                this.dom.content[1].style.transform =
                    `translate3d(-${this.data.last.two.toFixed(2)}px, 0, 0) scaleY(${bounce})`

                const scale = math.norm(this.data.last.two, 0, this.bounds.max)

                this.dom.handle.style.transform = `scaleX(${scale})`

                this.requestAnimationFrame()
            }

            on() {
                this.setStyles()
                this.setBounds(this.dom.elems[0])
                this.setBounds(this.dom.elems[1])
                this.addEvents()

                this.requestAnimationFrame()
            }

            requestAnimationFrame() {
                this.rAF = requestAnimationFrame(this.run)
            }

            resize() {
                this.setBounds()
            }

            addEvents() {
                window.addEventListener('scroll', this.scroll, {
                    passive: true
                })

                this.dom.el.addEventListener('mousemove', (e) => {
                    if (!this.state.dragging) return

                    this.drag(e)
                }, {
                    passive: true
                })

                this.dom.el.addEventListener('mousedown', (e) => {
                    this.state.dragging = true
                    this.data.on = e.clientX
                })

                window.addEventListener('mouseup', () => {
                    this.state.dragging = false
                    window.scrollTo(0, this.data.current)
                })
            }

            init() {
                this.preload()
                this.on()
            }
        }


        class Transition {
            constructor() {
                this.dom = {
                    mask: document.querySelector('.js-mask'),
                    slices: [...document.querySelectorAll('.js-mask__slice')],
                    triggers: [...document.querySelectorAll('.js-trigger')],
                    lines: [...document.querySelectorAll('.js-mask-line')],
                    logo: document.querySelector('.js-logo'),
                    images: [...document.querySelectorAll('.js-transition-img')],
                    imagesInner: [...document.querySelectorAll('.js-transition-img__inner')],
                    titles: [...document.querySelectorAll('.js-transition-title')]
                }

                this.tl = null
                this.state = false
                this.init()
            }

            resetScroll() {
                window.scrollTo(0, 0)
            }

            createTimeline() {
                this.tl = new TimelineMax({
                    paused: true,
                    onComplete: () => {
                        this.state = false
                    }
                })

                this.tl
                    .set([this.dom.images, this.dom.imagesInner], {
                        xPercent: 0,
                        scale: 1
                    })
                    .set(this.dom.titles, {
                        yPercent: 0
                    })
                    .set(this.dom.mask, {
                        autoAlpha: 1
                    })
                    .staggerFromTo(this.dom.slices, 1.5, {
                        xPercent: 100
                    }, {
                        xPercent: 0,
                        ease: Expo.easeInOut
                    }, -0.075)

                    .addCallback(this.resetScroll.bind(this))
                    .addLabel('loaderStart')

                    .set(this.dom.images, {
                        xPercent: -100
                    })
                    .set(this.dom.imagesInner, {
                        xPercent: 100
                    })
                    .set(this.dom.titles, {
                        yPercent: -100
                    })
                    .set([this.dom.lines[0], this.dom.logo], {
                        autoAlpha: 1
                    })
                    .fromTo(this.dom.logo, 1, {
                        yPercent: -100,
                        rotation: 10
                    }, {
                        yPercent: 0,
                        rotation: 0,
                        ease: Expo.easeOut
                    })
                    .staggerFromTo(this.dom.lines, 1, {
                        scaleX: 0
                    }, {
                        scaleX: 1,
                        ease: Expo.easeInOut
                    }, 0.75, "-=1")
                    .set(this.dom.lines, {
                        transformOrigin: 'right'
                    })
                    .fromTo(this.dom.lines[0], 1, {
                        scaleX: 1
                    }, {
                        scaleX: 0,
                        ease: Expo.easeInOut
                    })
                    .fromTo(this.dom.logo, 1, {
                        yPercent: 0
                    }, {
                        yPercent: 105,
                        ease: Expo.easeOut
                    }, "-=1")
                    .staggerFromTo(this.dom.slices, 1.5, {
                        xPercent: 0
                    }, {
                        xPercent: 100,
                        ease: Expo.easeInOut
                    }, 0.075)
                    .set(this.dom.mask, {
                        autoAlpha: 0
                    })

                    .addLabel('imagesStart', "-=0.85")

                    .staggerFromTo(this.dom.titles, 1.5, {
                        yPercent: 100
                    }, {
                        yPercent: 0,
                        ease: Expo.easeInOut
                    }, 0.05, 'imagesStart')
                    .staggerFromTo(this.dom.images, 1.25, {
                        xPercent: -100
                    }, {
                        xPercent: 0,
                        ease: Expo.easeInOut
                    }, 0.05, 'imagesStart')
                    .staggerFromTo(this.dom.imagesInner, 1.25, {
                        xPercent: 100
                    }, {
                        xPercent: 0,
                        ease: Expo.easeInOut
                    }, 0.05, 'imagesStart')

                    .addLabel('loaderEnd')
            }

            addEvents() {
                this.dom.triggers.forEach(trigger => {
                    trigger.addEventListener('click', (e) => {
                        e.preventDefault()

                        if (this.state) return

                        this.dom.triggers.forEach(el => {
                            el.classList.remove('is-active')
                        })
                        trigger.classList.add('is-active')

                        this.state = true
                        this.tl.restart()
                    })
                })
            }

            loader() {
                this.resetScroll()
                this.tl.tweenFromTo('loaderStart', 'loaderEnd')
            }

            init() {
                this.createTimeline()
                this.addEvents()
                this.loader()
            }
        }

        // Init classes
        const smooth = new Smooth()
        const transition = new Transition()

        // See shot - hover
        const btn = document.querySelector('.js-menu-btn')
    </script>
</body>

</html>